cpu "8085.tbl"
hof "int8"
org 9000h

GTHEX: EQU 030EH				;Gets hex digits and displays them
HXDSP: EQU 034FH				;Expands hex digits for display
OUTPUT:EQU 0389H				;Outputs characters to display
CLEAR: EQU 02BEH				;Clears the display
RDKBD: EQU 03BAH				;Reads keyboard

CURDT: EQU 8FF1H				;address of display
UPDDT: EQU 044cH				;data of display
CURAD: EQU 8FEFH				;Updates Data field of the display
UPDAD: EQU 0440H				;Updates Address field of the display

MVI A,00H 						;next 14 instructions used to display
MVI B,00H 						;"cloc" on display showing start of clock

LXI H,8840H
MVI M,0CH

LXI H,8841H
MVI M,11H

LXI H,8842H
MVI M,00H

LXI H,8843H
MVI M,0CH

LXI H,8840H
CALL OUTPUT
CALL RDKBD
CALL CLEAR 						;clear the display

MVI A,00H
MVI B,00H
CALL GTHEX
MOV A,E
STA 8005H

CALL CLEAR

; MVI A,80H
; OUT 43H

JMP MAIN

; SQUARE STARTS
SQUARE:
    MVI A,80H
    OUT 43H
LOOP:
	MVI A,0FFH
	STA 8000H
	CALL DELAY
	MVI A,00H
	STA 8000H
	CALL DELAY
    JMP MAIN
	; JMP LOOP

DELAY:
	CALL DIV16
	MVI C,01H
OUTLOOP:
	;LXI D,0FFFFH
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP
	DCR C
	JNZ OUTLOOP
	RET


DIV16:
	; PUSH PSW
    MVI B,03FH
    MVI C,0FFH
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H

    L5:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5E

        INX B
        JMP L5

    L5E:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

		; POP PSW
        RET

; SQUARE ENDS



; TRIANGLE STARTS

TRIANGLE:
    MVI A,80H
    OUT 43H
LOOPTR:
	MVI A,0FFH
	STA 8000H
	CALL DELAYTR
	MVI A,00H
	STA 8000H
	CALL DELAY2TR
    JMP MAIN
	; JMP LOOP

DELAYTR:
	CALL DIV16TR
OUTLOOPTR:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOPTR:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOPTR
	LDA 8000H
	SUB 05H
	STA 8000H
	JNZ OUTLOOPTR
	RET

DELAY2TR:
	CALL DIV162TR
OUTLOOP2TR:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP2TR:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP2TR
	LDA 8000H
	ADD 05H
	STA 8000H
	CPI 0FFH
	JC OUTLOOP2TR
	RET

DIV16TR:
	; PUSH PSW
    MVI B,00H
    MVI C,082H
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H
	JMP L5TR

DIV162TR:
	; PUSH PSW
    MVI B,00H
    MVI C,082H
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H
	JMP L5TR

    L5TR:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5ETR

        INX B
        JMP L5TR

    L5ETR:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

		; POP PSW
        RET


; TRIANGLE ENDS


; SAWTOOTH STARTS

SAW:
    MVI A,80H
    OUT 43H

LOOPSW:
	MVI A,0FFH
	STA 8000H
	CALL DELAYSW
    JMP MAIN
	; JMP LOOP

DELAYSW:
	CALL DIV16SW
OUTLOOPSW:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOPSW:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOPSW
	LDA 8000H
	SUB 05H
	STA 8000H
	JNZ OUTLOOPSW
	RET

DIV16SW:
	; PUSH PSW
    MVI B,01H
    MVI C,004H
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H

    L5SW:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5ESW

        INX B
        JMP L5SW

    L5ESW:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

		; POP PSW
        RET

; SAWTOOTH ENDS




;STAIR STARTS

STAIR:
    MVI A,80H
    OUT 43H
LOOPST:
	MVI A,00H
	STA 8000H
	CALL DELAYST
	JMP MAIN

DELAYST:
	CALL DIV16ST
OUTLOOPST:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOPST:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOPST
	LDA 8000H
	ADI 014H
	STA 8000H
	CPI 0C8H
	JC OUTLOOPST
	RET

DIV16ST:
    MVI B,17H
    MVI C,0CH
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H

    L5ST:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5EST

        INX B
        JMP L5ST

    L5EST:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

        RET

;STAIR ENDS






;SYMM STARTS


SYM:
    MVI A,80H
    OUT 43H
LOOPSY:
	MVI A,00H
	STA 8000H
	CALL DELAYSY
	MVI A,0B4H
	STA 8000H
	CALL DELAY2SY
	JMP MAIN

DELAYSY:
	CALL DIV16SY
OUTLOOPSY:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOPSY:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOPSY
	LDA 8000H
	ADI 014H
	STA 8000H
	CPI 0C8H
	JC OUTLOOPSY
	RET

DELAY2SY:
	CALL DIV16SY
OUTLOOP2SY:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP2SY:
	LDA 8000H
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP2SY
	LDA 8000H
	SBI 014H
	STA 8000H
	JNZ OUTLOOP2SY
	RET

DIV16SY:
    MVI B,0CH
    MVI C,04EH
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H

    L5SY:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5ESY

        INX B
        JMP L5SY

    L5ESY:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

        RET

;SYMM ENDS


;SINE STARTS



SINE:
    MVI A,80H
    OUT 43H


    MVI A,00H
    STA 8500H

    MVI A,06H
    STA 8501H

    MVI A,0DH
    STA 8502H

    MVI A,13H
    STA 8503H

    MVI A,1AH
    STA 8504H

    MVI A,20H
    STA 8505H

    MVI A,27H
    STA 8506H

    MVI A,2DH
    STA 8507H

    MVI A,33H
    STA 8508H

    MVI A,39H
    STA 8509H

    MVI A,3FH
    STA 850AH

    MVI A,45H
    STA 850BH

    MVI A,4AH
    STA 850CH

    MVI A,4FH
    STA 850DH

    MVI A,54H
    STA 850EH

    MVI A,59H
    STA 850FH

    MVI A,5EH
    STA 8510H

    MVI A,62H
    STA 8511H

    MVI A,66H
    STA 8512H

    MVI A,6AH
    STA 8513H

    MVI A,6DH
    STA 8514H

    MVI A,71H
    STA 85015H

    MVI A,74H
    STA 8516H

    MVI A,76H
    STA 8517H

    MVI A,78H
    STA 8518H

    MVI A,7AH
    STA 8519H

    MVI A,7CH
    STA 851AH

    MVI A,7DH
    STA 851BH

    MVI A,7EH
    STA 851CH

    MVI A,7EH
    STA 851DH

    MVI A,7FH
    STA 851EH


LOOPSI:
	CALL DELAYSI
	CALL DELAY2
	CALL DELAY3
	CALL DELAY4
	JMP MAIN


DELAYSI:
	CALL DIV16SI
	MVI H,85H
	MVI L,00H
OUTLOOPSI:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOPSI:
	;LDA 8000H
	MOV A,M
	;DIV162 ;divide a by 2
	ADI 7FH
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOPSI

	INR L
	MOV A,L
	CPI 1FH
	JC OUTLOOPSI
	RET

DELAY2:
	CALL DIV16SI
	MVI H,85H
	MVI L,1EH
OUTLOOP2:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP2:
	MOV A,M
	;DIV162 ;divide a by 2
	ADI 7FH
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP2

	DCR L
	MOV A,L
	JNZ OUTLOOP2
	RET

DELAY3:
	CALL DIV16SI
	MVI H,85H
	MVI L,00H
OUTLOOP3:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP3:
	MOV A,M
	XRI 0FFH
	ADI 01H
	SBI 7FH
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP3

	INR L
	MOV A,L
	CPI 1FH
	JC OUTLOOP3
	RET

DELAY4:
	CALL DIV16SI
	MVI H,85H
	MVI L,1EH
OUTLOOP4:
	LDA 8900H
	MOV D,A
	LDA 8901H
	MOV E,A

INLOOP4:
	MOV A,M
	XRI 0FFH
	ADI 01H
	SBI 7FH
	OUT 40H
	DCX D ; DECREMENT REG PAIR BY ONE
	MOV A,D
	ORA E ; LOGICAL OR OPERATION WITH FF(VALUE OF REG E)
	JNZ INLOOP4

	DCR L
	MOV A,L
	JNZ OUTLOOP4
	RET

DIV16SI:
    MVI B,01H
    MVI C,0CEH
    MVI D,00H
    LDA 8005H
	MOV E,A

    MOV H,B
    MOV L,C

    MVI B,00H
    MVI C,00H

    L5SI:
        MOV A,L
        SUB E
        MOV L,A
        MOV A,H
        SBB D
        MOV H,A

        JC L5ESI

        INX B
        JMP L5SI

    L5ESI:
        MVI H, 89H
        MVI L, 00H
        MOV M,B
        INR L
        MOV M,C

        RET










;SINE ENDS


MAIN:
    MVI A,8BH
    OUT 03H

    IN 01H
    ANI 080H
    CPI 080H
    JNZ SQUARE

    IN 01H
    ANI 040H
    CPI 040H
    JNZ TRIANGLE

    IN 01H
    ANI 020H
    CPI 020H
    JNZ SAW

    IN 01H
    ANI 010H
    CPI 010H
    JNZ STAIR

    IN 01H
    ANI 08H
    CPI 08H
    JNZ SYM

    IN 01H
    ANI 04H
    CPI 04H
    JNZ SINE

    JMP MAIN


END:
    RST 5
